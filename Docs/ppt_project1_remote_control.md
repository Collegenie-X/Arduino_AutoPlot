# 🟢 Project 1: 원격 제어 시스템 (음성 STT)

---

## Slide 1: 표지

### 🎮 스마트카 원격 제어 시스템
**블루투스 + 음성 인식 (STT)**

- 실제 자율주행 연계: V2X 통신 & 텔레오퍼레이션
- 난이도: ★☆☆☆☆ (입문)
- 소요 시간: 2시간

---

## Slide 2: 학습 목표

### 🎯 이 프로젝트를 마치면...

1. **블루투스 통신 원리**를 이해할 수 있다
2. **App Inventor**로 앱을 제작할 수 있다
3. **음성 인식(STT)**을 활용할 수 있다
4. 실제 **텔레오퍼레이션** 기술을 이해할 수 있다

---

## Slide 3: 실제 자율주행 연계

### 🚗 V2X 통신 & 텔레오퍼레이션

```
┌─────────────────────────────────────────────┐
│           실제 자율주행 시스템               │
├─────────────────────────────────────────────┤
│                                             │
│   [관제 센터] ←──5G/LTE──→ [자율주행차]      │
│       │                        │            │
│       └── 원격 모니터링 ────────┘            │
│       └── 긴급 시 원격 조종 ────┘            │
│                                             │
├─────────────────────────────────────────────┤
│           우리 프로젝트                      │
├─────────────────────────────────────────────┤
│                                             │
│   [스마트폰] ←──Bluetooth──→ [스마트카]      │
│       │                        │            │
│       └── 음성 명령 ───────────┘            │
│       └── 버튼 제어 ───────────┘            │
│                                             │
└─────────────────────────────────────────────┘
```

**실제 사례**: 웨이모(Waymo) 원격 지원 시스템, 현대모비스 5G 원격 주행

---

## Slide 4: 시스템 구성도

### 🔧 하드웨어 연결

```
┌─────────────────────────────────────────────┐
│                                             │
│   [스마트폰]                                │
│       │                                     │
│       │ Bluetooth                           │
│       ▼                                     │
│   ┌─────────┐                              │
│   │ HC-06   │ ← 블루투스 모듈              │
│   └────┬────┘                              │
│        │ TX/RX                              │
│        ▼                                    │
│   ┌─────────┐                              │
│   │ Arduino │ ← 제어 장치                  │
│   │   UNO   │                              │
│   └────┬────┘                              │
│        │ PWM 신호                           │
│        ▼                                    │
│   ┌─────────┐                              │
│   │ Motor   │ ← DC 모터 4개                │
│   │ Driver  │                              │
│   └─────────┘                              │
│                                             │
└─────────────────────────────────────────────┘
```

---

## Slide 5: 핀 연결 다이어그램

### 📍 아두이노 핀 배치

```
        Arduino UNO
    ┌─────────────────┐
    │                 │
    │  D3 ──→ BT TX   │
    │  D4 ──→ BT RX   │
    │                 │
    │  D5 ──→ Motor1+ │  (오른쪽 전진)
    │  D6 ──→ Motor1- │  (오른쪽 후진)
    │                 │
    │  D8 ──→ PIEZO   │  (부저)
    │                 │
    │  D11 ─→ Motor2+ │  (왼쪽 전진)
    │  D12 ─→ Motor2- │  (왼쪽 후진)
    │                 │
    │  5V ──→ HC-06   │
    │  GND ─→ HC-06   │
    │                 │
    └─────────────────┘
```

---

## Slide 6: 블루투스 통신 원리

### 📡 시리얼 통신 흐름

```
┌─────────────────────────────────────────────┐
│                                             │
│  스마트폰 앱                                │
│      │                                      │
│      │ "UP_" 문자열 전송                    │
│      ▼                                      │
│  HC-06 모듈                                 │
│      │                                      │
│      │ 시리얼 데이터 (9600 baud)            │
│      ▼                                      │
│  SoftwareSerial                             │
│      │                                      │
│      │ BTSerial.read()                      │
│      ▼                                      │
│  문자열 버퍼                                │
│      │                                      │
│      │ "UP" + "_" 감지                      │
│      ▼                                      │
│  명령 실행: Forward()                       │
│                                             │
└─────────────────────────────────────────────┘
```

---

## Slide 7: 명령어 프로토콜

### 📋 통신 규약

| 앱 전송 | 아두이노 수신 | 동작 |
|---------|---------------|------|
| `UP_` | "UP" | 전진 |
| `DOWN_` | "DOWN" | 후진 |
| `LEFT_` | "LEFT" | 좌회전 |
| `RIGHT_` | "RIGHT" | 우회전 |
| `STOP_` | "STOP" | 정지 |
| `FAST_` | "FAST" | 고속 모드 |
| `SLOW_` | "SLOW" | 저속 모드 |
| `HORN_` | "HORN" | 경적 |

**구분자**: `_` (언더스코어)

---

## Slide 8: 핵심 코드 분석

### 💻 블루투스 수신 처리

```arduino
while (BTSerial.available()) {
    // 1. 한 글자씩 읽기
    inBTChar = (char)BTSerial.read();
    
    // 2. 구분자 확인
    if (inBTChar == '_') {
        // 3. 명령어 매칭
        if (inputBTString.equals("UP")) {
            Forward();  // 전진
        }
        else if (inputBTString.equals("DOWN")) {
            Backward();  // 후진
        }
        // ... 생략 ...
        
        // 4. 버퍼 초기화
        inputBTString = "";
    }
    else {
        // 5. 문자열 누적
        inputBTString += inBTChar;
    }
}
```

---

## Slide 9: 모터 제어 함수

### ⚙️ 방향별 모터 제어

```
┌─────────────────────────────────────────────┐
│                                             │
│   [전진 Forward()]                          │
│   ┌─────┐   ┌─────┐                        │
│   │ M1+ │   │ M2+ │  ← 양쪽 모터 정방향     │
│   │ ON  │   │ ON  │                        │
│   └─────┘   └─────┘                        │
│                                             │
│   [좌회전 Left()]                           │
│   ┌─────┐   ┌─────┐                        │
│   │ M1+ │   │ M2  │  ← 오른쪽만 동작        │
│   │ ON  │   │ OFF │                        │
│   └─────┘   └─────┘                        │
│                                             │
│   [우회전 Right()]                          │
│   ┌─────┐   ┌─────┐                        │
│   │ M1  │   │ M2+ │  ← 왼쪽만 동작         │
│   │ OFF │   │ ON  │                        │
│   └─────┘   └─────┘                        │
│                                             │
└─────────────────────────────────────────────┘
```

---

## Slide 10: App Inventor 화면 설계

### 📱 UI 레이아웃

```
┌─────────────────────────────────────────┐
│  ┌─────────────────────────────────┐   │
│  │   🔗 블루투스 연결              │   │
│  └─────────────────────────────────┘   │
├─────────────────────────────────────────┤
│                                         │
│           ┌───────────┐                │
│           │    🎤     │                │
│           │  음성     │                │
│           │  인식     │                │
│           └───────────┘                │
│                                         │
│     인식된 텍스트: "앞으로 가"          │
│                                         │
├─────────────────────────────────────────┤
│      ┌───┐                             │
│      │ ▲ │  UP                         │
│      └───┘                             │
│  ┌───┐     ┌────┐     ┌───┐           │
│  │ ◄ │     │STOP│     │ ► │           │
│  └───┘     └────┘     └───┘           │
│      ┌───┐                             │
│      │ ▼ │  DOWN                       │
│      └───┘                             │
├─────────────────────────────────────────┤
│  상태: 연결됨  │  속도: 보통            │
└─────────────────────────────────────────┘
```

---

## Slide 11: App Inventor 컴포넌트

### 🧩 필요한 컴포넌트

```
┌─────────────────────────────────────────────┐
│                                             │
│   User Interface                            │
│   ├── ListPicker (블루투스 선택)            │
│   ├── Button x 6 (방향 + 정지)              │
│   ├── Label x 2 (상태 표시)                 │
│   └── Image (로고)                          │
│                                             │
│   Media                                     │
│   └── SpeechRecognizer (음성 인식)          │
│                                             │
│   Connectivity                              │
│   └── BluetoothClient (블루투스)            │
│                                             │
│   Sensors                                   │
│   └── Clock (타이머, 선택사항)              │
│                                             │
└─────────────────────────────────────────────┘
```

---

## Slide 12: 음성 인식 (STT) 흐름

### 🎤 Speech-to-Text 처리

```
┌─────────────────────────────────────────────┐
│                                             │
│   사용자: "앞으로 가"                        │
│           │                                 │
│           ▼                                 │
│   ┌─────────────────┐                      │
│   │ SpeechRecognizer │                      │
│   │   GetText()     │                      │
│   └────────┬────────┘                      │
│            │                                │
│            ▼                                │
│   ┌─────────────────┐                      │
│   │ Google STT API  │                      │
│   │  (음성 → 텍스트)│                      │
│   └────────┬────────┘                      │
│            │                                │
│            ▼                                │
│   Result = "앞으로 가"                      │
│            │                                │
│            ▼                                │
│   ┌─────────────────┐                      │
│   │ 키워드 매칭     │                      │
│   │ "앞" 포함?      │ ─── Yes ──→ "UP_"   │
│   └─────────────────┘                      │
│                                             │
└─────────────────────────────────────────────┘
```

---

## Slide 13: 음성 명령어 매핑

### 🗣️ 한국어 음성 → 명령어

| 음성 입력 예시 | 키워드 | 전송 명령 |
|----------------|--------|-----------|
| "앞으로", "전진", "가" | 앞, 전진, 가 | UP_ |
| "뒤로", "후진", "백" | 뒤, 후진, 백 | DOWN_ |
| "왼쪽", "좌회전" | 왼, 좌 | LEFT_ |
| "오른쪽", "우회전" | 오른, 우 | RIGHT_ |
| "멈춰", "정지", "스톱" | 멈, 정지, 스톱 | STOP_ |
| "빨리", "빨리 가" | 빨 | FAST_ |
| "천천히" | 천천 | SLOW_ |
| "경적", "빵빵" | 경적, 빵 | HORN_ |

---

## Slide 14: App Inventor 블록 설계

### 🧱 핵심 블록 구조

```
[ListPicker.BeforePicking]
└── set ListPicker.Elements to
    BluetoothClient.AddressesAndNames

[ListPicker.AfterPicking]
└── call BluetoothClient.Connect(Selection)
└── set Label_Status.Text = "연결됨"

[Button_Voice.Click]
└── call SpeechRecognizer.GetText

[SpeechRecognizer.AfterGettingText]
└── set Label_Result.Text = result
└── if result contains "앞"
    └── call BluetoothClient.SendText("UP_")
└── else if result contains "뒤"
    └── call BluetoothClient.SendText("DOWN_")
└── else if result contains "왼"
    └── call BluetoothClient.SendText("LEFT_")
└── else if result contains "오른"
    └── call BluetoothClient.SendText("RIGHT_")
└── else if result contains "멈"
    └── call BluetoothClient.SendText("STOP_")
```

---

## Slide 15: 코드 수정 과제

### ✏️ 실습 1: 새 명령어 추가

**목표**: "HORN" 명령어 추가하기

```arduino
// 기존 코드에 추가
else if (inputBTString.equals("HORN")) {
    tone(PIEZO, 1000, 500);  // 1000Hz, 500ms
    BTSerial.print("HORN:OK");
}
```

**테스트**: 앱에서 "경적" 또는 버튼으로 "HORN_" 전송

---

## Slide 16: 코드 수정 과제

### ✏️ 실습 2: 속도 조절 기능

**목표**: FAST/SLOW 명령으로 속도 변경

```arduino
// 전역 변수
int currentSpeed = 150;  // 기본 속도

// 명령어 처리에 추가
else if (inputBTString.equals("FAST")) {
    currentSpeed = 200;
    BTSerial.print("SPEED:FAST");
}
else if (inputBTString.equals("SLOW")) {
    currentSpeed = 100;
    BTSerial.print("SPEED:SLOW");
}

// Forward() 함수 수정
void Forward() {
    analogWrite(MOTOR_1, currentSpeed);  // 변수 사용
    // ...
}
```

---

## Slide 17: 테스트 체크리스트

### ✅ 기능 테스트

| 테스트 항목 | 방법 | 예상 결과 | Pass |
|-------------|------|-----------|:----:|
| 블루투스 연결 | ListPicker 선택 | "연결됨" 표시 | ☐ |
| 전진 버튼 | UP 버튼 클릭 | 앞으로 이동 | ☐ |
| 음성 "앞으로" | 마이크 버튼 → 말하기 | 앞으로 이동 | ☐ |
| 음성 "멈춰" | 마이크 버튼 → 말하기 | 즉시 정지 | ☐ |
| 경적 HORN | HORN 버튼/음성 | 부저 울림 | ☐ |
| 속도 변경 | FAST/SLOW | 속도 변화 체감 | ☐ |

---

## Slide 18: 트러블슈팅

### 🔧 자주 발생하는 문제

```
┌─────────────────────────────────────────────┐
│ 문제: 블루투스 연결 안됨                    │
├─────────────────────────────────────────────┤
│ 원인                     해결 방법          │
│ ─────────────────────────────────────────── │
│ 페어링 안됨              설정에서 페어링    │
│ 핀코드 오류              1234 입력          │
│ 다른 앱 연결 중          앱 종료 후 재시도   │
└─────────────────────────────────────────────┘

┌─────────────────────────────────────────────┐
│ 문제: 명령 전송했는데 동작 안함             │
├─────────────────────────────────────────────┤
│ 원인                     해결 방법          │
│ ─────────────────────────────────────────── │
│ TX/RX 뒤바뀜             선 교체            │
│ 명령어 오타              대소문자 확인      │
│ 구분자 누락              "_" 추가 확인      │
└─────────────────────────────────────────────┘
```

---

## Slide 19: 확장 아이디어

### 💡 추가 도전 과제

1. **속도 슬라이더**: 버튼 대신 슬라이더로 속도 조절
2. **조이스틱 모드**: 터치 위치로 방향/속도 결정
3. **매크로 기능**: "8자 주행" 음성 명령
4. **상태 피드백**: 아두이노에서 배터리 상태 전송
5. **음성 피드백**: TTS로 동작 완료 음성 안내

---

## Slide 20: 정리 및 다음 단계

### 📌 이번 프로젝트 요약

- ✅ 블루투스 시리얼 통신 이해
- ✅ App Inventor 앱 제작
- ✅ 음성 인식 (STT) 활용
- ✅ 실제 텔레오퍼레이션 기술 연계

### ➡️ 다음 프로젝트

**🟡 Project 2: 라인 트레이서**
- IR 센서로 검정 라인 인식
- 실제 LKAS (차선 유지) 기술 체험

---

*© 2025 스마트카 원격 제어 프로젝트*

